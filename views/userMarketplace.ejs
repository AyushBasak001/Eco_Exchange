<%- include('partials/htmlHead.ejs') %>

<body>
    <div>
        <%- include('partials/topBar.ejs') %>
    </div>

    <div>
        <%- include('partials/userSidebar.ejs') %>
    </div>

    <div>
        <!-- ================= HEADER ================= -->
        <header class="marketplace-header">
            <div class="container">
                <h1 class="marketplace-title">Eco-Exchange Marketplace</h1>
                <p class="marketplace-subtitle">
                    Buy and sell recyclable materials responsibly üå±
                </p>
            </div>
        </header>

        <!-- ================= INFO STRIP ================= -->
        <section class="info-strip">
            <div class="container info-grid">
                <div class="info-card">
                    <h3>‚ôª Sustainable Trade</h3>
                    <p>Every purchase supports eco-friendly waste reuse.</p>
                </div>
                <div class="info-card">
                    <h3>ü§ù Trusted Sellers</h3>
                    <p>Verified users ensuring transparent transactions.</p>
                </div>
                <div class="info-card">
                    <h3>üì¶ Real-Time Stock</h3>
                    <p>Live quantity updates for fair purchasing.</p>
                </div>
            </div>
        </section>

        <!-- ================= MARKETPLACE ================= -->
        <main class="marketplace-section">
            <div class="container">

                <h2 class="section-heading">Available Products</h2>

                <div class="product-grid">
                    <% products.forEach(product => { %>
                        <div class="product-card">

                            <div class="product-header">
                                <h3 class="product-title"><%= product.title %></h3>
                                <span class="product-price">‚Çπ <%= product.price %></span>
                            </div>

                            <div class="product-meta">
                                <p class="product-seller">
                                    Seller: <strong><%= product.seller_name %></strong>
                                </p>
                                <p class="product-quantity">
                                    Available: <%= product.quantity_available %>
                                </p>
                            </div>

                            <% if (product.quantity_available > 0) { %>
                                <form class="buy-form" action="/user/orders/create" method="POST">
                                    <input type="hidden" name="product_id" value="<%= product.id %>">

                                    <input
                                        class="quantity-input"
                                        type="number"
                                        name="quantity"
                                        min="1"
                                        max="<%= product.quantity_available %>"
                                        placeholder="Qty"
                                        required
                                    >

                                    <button class="buy-btn" type="submit">
                                        Buy Now
                                    </button>
                                </form>
                            <% } else { %>
                                <p class="sold-out-badge">Sold Out</p>
                            <% } %>

                        </div>
                    <% }) %>
                </div>

            </div>
        </main>

    </div>

    <div>
        <%- include('partials/footer.ejs') %>
    </div>
</body>
</html>